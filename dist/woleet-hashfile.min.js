"use strict";!function(e,r){e.woleet=r(e.woleet)}(window,function(e){function r(){var e=document.getElementsByTagName("script"),r=e[e.length-1].src,t=r.substr(0,r.lastIndexOf("/")+1);return t}function t(){function e(e){var r=window.URL||window.webkitURL,t=window.Blob,n=window.Worker;if(!(r&&t&&n&&e))return null;var o=new t([e]);return new n(r.createObjectURL(o))}return new Promise(function(r){var t="onmessage = function(e) { postMessage(!!FileReaderSync); };";try{var n=e(t);n?(n.onmessage=function(e){r(e.data)},n.postMessage({})):r(!1)}catch(e){r(!1)}})}var n=r(),o="worker.min.js",a=e.workerScriptPath||(n?n+o:null);if(!a)throw new Error("Cannot find "+o);var i=t(),s=e||{};return s.file=s.file||{},s.file.Hasher=function(){var e,r,t,n,o=!0;this.on=function(o,a){switch(o){case"start":e=a;break;case"progress":r=a;break;case"error":n=a;break;case"result":t=a;break;default:throw new Error('Invalid event name "'+o+'"')}};var s=function(i,s){function f(){l>=s?(c.terminate(),o=!0):(c.postMessage(i.item(l)),l++)}var l=0,c=new Worker(a);c.onmessage=function(o){if(void 0!=o.data.progress)r&&r(o.data);else if(o.data.result)t&&t(o.data),f();else if(o.data.start)e&&e(o.data);else if(o.data.error){var a=o.data.error;if(!n)throw a;n(a)}else console.trace("Unexpected worker message: ",o)},s!=-1?f():c.postMessage(i)},f=function(a,i){function s(a){var i=new Error("file_too_big_to_be_hashed_without_worker");if(a.size>5e7){if(o=!0,n)return n({error:i,file:a});throw i}e&&e({start:!0,file:a});var s,l=new FileReader,c=CryptoJS.algo.SHA256.create(),u=0;l.onloadend=function(){s.finalize(),t&&t({result:s._hash.toString(CryptoJS.enc.Hex),file:a}),f()},l.onprogress=function(e){var t=e.target.result,n=t.slice(u,e.loaded),o=new Uint8Array(n),i=CryptoJS.lib.WordArray.create(o);s=c.update(i),u=e.loaded,r&&r({progress:e.loaded/e.total,file:a})},l.readAsArrayBuffer(a)}function f(){l>=i?o=!0:(s(a.item(l)),l++)}var l=0;i!=-1?f():s(a)};this.start=function(e){if(!o)throw new Error("not_ready");var r=-1;if(e instanceof FileList)r=e.length;else if(!(e instanceof File))throw new Error("invalid_parameter");o=!1,i.then(function(t){if(t)s(e,r);else{if("undefined"==typeof CryptoJS)throw new Error("no_viable_hash_method");f(e,r)}})},this.isReady=function(){return o}},s._hashStringOrFile=function(e,r){var t,n,o=new Promise(function(e,r){t=e,n=r});if(e instanceof File){if(!s.file||!s.file.Hasher)throw new Error("missing_woleet_hash_dependency");var a=new s.file.Hasher;a.on("result",function(e,n){t(e.result),r&&r({progress:1,file:File})}),r&&"function"==typeof r&&a.on("progress",r),a.on("error",function(e){n(e)}),a.start(e)}else"string"==typeof e?s.isSHA256(e)?t(e):n(new Error("parameter_string_not_a_sha256_hash")):n(new Error("invalid_parameter"));return o},s});
//# sourceMappingURL=woleet-hashfile.min.js.map
