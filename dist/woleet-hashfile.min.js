"use strict";!function(e,r){e.woleet=r(e.woleet)}(window,function(e){function r(){var e=document.getElementsByTagName("script"),r=e[e.length-1].src,t=r.substr(0,r.lastIndexOf("/")+1);return t}function t(){function e(e){var r=window.URL||window.webkitURL,t=window.Blob,n=window.Worker;if(!(r&&t&&n&&e))return null;var a=new t([e]);return new n(r.createObjectURL(a))}return new Promise(function(r){var t="onmessage = function(e) { postMessage(!!FileReaderSync); };";try{var n=e(t);n?(n.onmessage=function(e){r(e.data)},n.postMessage({})):r(!1)}catch(e){r(!1)}})}var n=r(),a="woleet-hashfile-worker.min.js",o=e.workerScriptPath||(n?n+a:null);if(!o)throw new Error("Cannot find "+a);var i=t(),s=e||{};return s.file=s.file||{},s.file.Hasher=function(){var e,r,t,n,a=!0;this.on=function(a,o){switch(a){case"start":e=o;break;case"progress":r=o;break;case"error":n=o;break;case"result":t=o;break;default:throw new Error('Invalid event name "'+a+'"')}};var s=function(i,s){function f(){l>=s?(c.terminate(),a=!0):(c.postMessage(i.item(l)),l++)}var l=0,c=new Worker(o);c.onmessage=function(a){if(void 0!=a.data.progress)r&&r(a.data);else if(a.data.result)t&&t(a.data),f();else if(a.data.start)e&&e(a.data);else if(a.data.error){var o=a.data.error;if(!n)throw o;n(o)}else console.trace("Unexpected worker message: ",a)},s!=-1?f():c.postMessage(i)},f=function(o,i){function s(o){var i=new Error("file_too_big_to_be_hashed_without_worker");if(o.size>5e7){if(a=!0,n)return n({error:i,file:o});throw i}e&&e({start:!0,file:o});var s,l=new FileReader,c=CryptoJS.algo.SHA256.create(),u=0;l.onloadend=function(){s.finalize(),t&&t({result:s._hash.toString(CryptoJS.enc.Hex),file:o}),f()},l.onprogress=function(e){var t=e.target.result,n=t.slice(u,e.loaded),a=new Uint8Array(n),i=CryptoJS.lib.WordArray.create(a);s=c.update(i),u=e.loaded,r&&r({progress:e.loaded/e.total,file:o})},l.readAsArrayBuffer(o)}function f(){l>=i?a=!0:(s(o.item(l)),l++)}var l=0;i!=-1?f():s(o)};this.start=function(e){if(!a)throw new Error("not_ready");var r=-1;if(e instanceof FileList)r=e.length;else if(!(e instanceof File))throw new Error("invalid_parameter");a=!1,i.then(function(t){if(t)s(e,r);else{if("undefined"==typeof CryptoJS)throw new Error("no_viable_hash_method");f(e,r)}})},this.isReady=function(){return a}},s});
//# sourceMappingURL=woleet-hashfile.min.js.map
