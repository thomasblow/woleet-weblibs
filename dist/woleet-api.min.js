"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(t,e){t.woleet=e(t.woleet)}(window,function(t){function e(t){this.name="getJSON",this.message=t.statusText&&t.statusText.length?t.statusText:"Error while getting data",this.code=t.status,this.body=t.response,this.stack=(new Error).stack}function n(t,n){var o=new XMLHttpRequest;return new Promise(function(r,a){o.onload=function(){switch(o.status){case 200:case 201:r("string"==typeof o.response?JSON.parse(o.response):o.response);break;case 404:r(null);break;default:a(new e(o))}},o.onerror=function(){a(new e(o))},o.open(n.method||"GET",t,!0),n.token&&o.setRequestHeader("Authorization","Bearer "+n.token),o.setRequestHeader("Content-Type","application/json"),o.setRequestHeader("Accept","application/json"),o.responseType="json",o.json="json",o.send("object"==_typeof(n.data)?JSON.stringify(n.data):n.data)})}function o(t,e,n,o,r){return"Invalid Date"==n.toString()&&(n=null),{txId:t,confirmations:e,confirmedOn:n,blockHash:o,opReturn:r}}e.prototype=Object.create(Error.prototype),e.prototype.constructor=e;var r="https://api.woleet.io/v1",a=t||{};return a.receipt=a.receipt||{},a.anchor=a.anchor||{},a.transaction=function(){var t="woleet.io";return{setDefaultProvider:function(e){switch(e){case"blockcypher.com":t=e;break;case"woleet.io":t=e;break;case"chain.so":default:t="chain.so"}},get:function(e){switch(t){case"woleet.io":return n(r+"/bitcoin/transaction/"+e).then(function(t){if(t)return o(t.txid,t.confirmations,new Date(1e3*t.time),t.blockhash||0,function(t){var e=null;return t.forEach(function(t){if(t.hasOwnProperty("scriptPubKey")&&t.scriptPubKey.hasOwnProperty("asm")&&t.scriptPubKey.asm.indexOf("OP_RETURN")!=-1&&(e=t.scriptPubKey.asm.split(" ")[1]),e)return!0}),e}(t.vout||[]));throw new Error("tx_not_found")});case"chain.so":return n("https://chain.so/api/v2/get_tx/BTC/"+e).then(function(t){if(t&&"fail"!=t.status)return o(t.data.txid,t.data.confirmations,new Date(1e3*t.data.time),t.data.blockhash,function(t){var e=null;return t.forEach(function(t){if(t.hasOwnProperty("script")&&(t.script.indexOf("OP_RETURN")!=-1&&(e=t.script.split(" ")[1]),e))return!0}),e}(t.data.outputs||[]));throw new Error("tx_not_found")});case"blockcypher.com":return n("https://api.blockcypher.com/v1/btc/main/txs/"+e).then(function(t){if(!t||t.error)throw new Error("tx_not_found");return o(t.hash,t.confirmations,new Date(t.confirmed),t.block_hash,function(t){var e=null;return t.forEach(function(t){if(t.hasOwnProperty("data_hex")&&(e=t.data_hex),e)return!0}),e}(t.outputs||[]))})}}}}(),a.anchor.getAnchorIDs=function(t,e){return e=e||20,n(r+"/anchorids?size="+e+"&hash="+t)},a.receipt.get=function(t){return n(r+"/receipt/"+t).then(function(t){if(t)return t;throw new Error("not_found")})},a.isSHA256=function(t){var e=/^[A-Fa-f0-9]{64}$/;return e.test(t)},a._getJSON=n,a._woleetAPI=r,a});
//# sourceMappingURL=woleet-api.min.js.map
