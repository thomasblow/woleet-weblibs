{"version":3,"sources":["woleet-api.js","woleet-chainpoint.js","woleet-verify.js","woleet-hashfile.js"],"names":["root","factory","woleet","window","RequestError","req","this","name","message","statusText","length","code","status","body","response","stack","Error","getJSON","url","options","arguments","undefined","XMLHttpRequest","Promise","resolve","reject","onload","JSON","parse","onerror","open","method","token","setRequestHeader","responseType","json","send","_typeof","data","stringify","makeTransaction","txId","confirmations","confirmedOn","blockHash","opReturn","toString","prototype","Object","create","constructor","woleetAPI","api","receipt","anchor","transaction","default_api","setDefaultProvider","get","then","res","txid","Date","time","blockhash","outputs","opr_return_found","forEach","output","hasOwnProperty","scriptPubKey","asm","indexOf","split","vout","script","error","hash","confirmed","block_hash","data_hex","getAnchorIDs","size","anchorId","isSHA256","sha256RegExp","test","_getJSON","_woleetAPI","MerkleBranch","left","right","hash_f","_hash_f","sha256","_left","_right","_parent","get_parent","contains","target","get_json","parent","MerkleProof","self","branches","add","branch","push","is_valid","new_target","i","json_data","R","n","x","F0","F1","S0","S1","Ch","y","z","Maj","msg","K","H","String","fromCharCode","l","N","Math","ceil","M","Array","j","charCodeAt","lenHi","pow","lenLo","floor","W","t","a","b","c","d","e","f","g","h","T1","T2","slice","join","validate","target_hash","target_proof","header","hash_type","merkle_root","tx_id","proof","merkleBranch","verify","WoleetDAB","file","progressCallback","hashFileOrCheckHash","anchorIDsPage","receiptArray","content","reduce","chain","catch","receiptsCheckOk","map","err","receiptsOk","every","_ret","finalArray","v","tx","DAB","findBasePath","scripts","document","getElementsByTagName","scriptsArray","call","regex","find","src","match","substr","lastIndexOf","checkFileReaderSyncSupport","makeWorker","URL","webkitURL","Blob","Worker","blob","createObjectURL","syncDetectionScript","worker","onmessage","postMessage","isHTTPS","location","protocol","testNativeCryptoSupport","crypto","subtle","digest","testFileReaderSupport","basePath","DEFAULT_WORKER_SCRIPT","workerScriptPath","Hasher","ready","cb_start","cb_progress","cb_result","cb_error","on","event","callback","HashWorker","next","progress","result","start","console","trace","hashLocal","reader","FileReader","CryptoJS","algo","SHA256","prev","onloadstart","onloadend","finalize","_hash","enc","Hex","onprogress","buf","loaded","chunkUint8","Uint8Array","wordArr","lib","WordArray","update","total","readAsArrayBuffer","hashLocalWithNativeAPI","hashResult","hexString","files","max_native_crypto_size","hashWorker","FileList","File","WorkerSupported","iter","len","terminate","hashMethod","_worker","isReady","hasher"],"mappings":"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","file":"woleet-weblibs.min.js","sourcesContent":["/**\n * @typedef {Object}   AnchorIDsPage\n * @typedef {String[]} Page.content array of anchorID\n * @typedef {Number}   Page.totalPages number of pages with the current size\n * @typedef {Number}   Page.totalElements number of elements matching the request\n * @typedef {Boolean}  Page.last boolean that indicates if the current page is the last one\n * @typedef {Boolean}  Page.sort boolean that indicates if the current page is the last one\n * @typedef {Boolean}  Page.first boolean that indicates if the current page is the first one\n * @typedef {Number}   Page.numberOfElements number of elements matching the request on the current page\n * @typedef {Number}   Page.size current page size\n * @typedef {Number}   Page.number current number (starting at 0)\n */\n\n;(function (root, factory) {\n    root.woleet = factory(root.woleet)\n})(window, function (woleet) {\n\n    function RequestError(req) {\n        this.name = 'getJSON';\n        this.message = req.statusText && req.statusText.length ? req.statusText : 'Error while getting data';\n        this.code = req.status;\n        //noinspection JSUnusedGlobalSymbols\n        this.body = req.response;\n        this.stack = (new Error()).stack;\n    }\n\n    RequestError.prototype = Object.create(Error.prototype);\n    //noinspection JSUnusedGlobalSymbols\n    RequestError.prototype.constructor = RequestError;\n\n    /**\n     * @param {String} url\n     * @param {{method?:string, data?:string, token?:string}} options\n     * @returns {Promise}\n     */\n    function getJSON(url, options = {}) {\n        var req = new XMLHttpRequest();\n\n        return new Promise(function (resolve, reject) {\n\n            req.onload = function () {\n\n                switch (req.status) {\n                    case 200:\n                    case 201:\n                        typeof req.response == \"string\" ? resolve(JSON.parse(req.response)) : resolve(req.response); // ie\n                        break;\n                    case 404:\n                        resolve(null);\n                        break;\n                    default:\n                        reject(new RequestError(req));\n                        break;\n                }\n            };\n\n            req.onerror = function () {\n                reject(new RequestError(req));\n            };\n\n            req.open(options.method || \"GET\", url, true);\n            if (options.token) req.setRequestHeader(\"Authorization\", \"Bearer \" + options.token);\n            if (options.method == 'POST') req.setRequestHeader('Content-Type', 'application/json');\n            req.setRequestHeader('Accept', 'application/json');\n            req.responseType = \"json\";\n            req.json = \"json\";\n            req.send(typeof options.data == 'object' ? JSON.stringify(options.data) : options.data);\n        });\n    }\n\n    /**\n     * @param {String} txId\n     * @param {Number} confirmations\n     * @param {Date} confirmedOn\n     * @param {String} blockHash\n     * @param {String} opReturn\n     */\n    function makeTransaction(txId, confirmations, confirmedOn, blockHash, opReturn) {\n\n        if (confirmedOn.toString() == \"Invalid Date\")\n            confirmedOn = null;\n\n        return {\n            txId: txId,\n            confirmations: confirmations,\n            confirmedOn: confirmedOn,\n            blockHash: blockHash,\n            opReturn: opReturn\n        }\n    }\n\n    var woleetAPI = \"https://api.woleet.io/v1\";\n    var api = woleet || {};\n    api.receipt = api.receipt || {};\n    api.anchor = api.anchor || {};\n\n    api.transaction = (function () {\n        var default_api = 'woleet.io';\n\n        return {\n            setDefaultProvider: function (api) {\n                switch (api) {\n                    case 'blockcypher.com':\n                        default_api = api;\n                        break;\n                    case 'woleet.io':\n                        default_api = api;\n                        break;\n                    case 'chain.so':\n                    default:\n                        default_api = 'chain.so';\n                        break;\n                }\n            },\n\n            /**\n             * @param txId\n             * @returns {Promise.<Transaction>}\n             */\n            get: function (txId) {\n                switch (default_api) {\n                    case 'woleet.io':\n                        return getJSON(woleetAPI + '/bitcoin/transaction/' + txId)\n                            .then(function (res) {\n                                if (!res) {\n                                    throw new Error('tx_not_found');\n                                }\n                                else {\n                                    //noinspection JSUnresolvedVariable\n                                    return makeTransaction(res.txid, res.confirmations, new Date(res.time * 1000), res.blockhash || 0,\n                                        (function (outputs) {\n                                            var opr_return_found = null;\n                                            outputs.forEach(function (output) {\n                                                if (output.hasOwnProperty('scriptPubKey')) {\n                                                    //noinspection JSUnresolvedVariable\n                                                    if (output.scriptPubKey.hasOwnProperty('asm')) {\n                                                        //noinspection JSUnresolvedVariable\n                                                        if (output.scriptPubKey.asm.indexOf('OP_RETURN') != -1) {\n                                                            //noinspection JSUnresolvedVariable\n                                                            opr_return_found = (((output.scriptPubKey.asm).split(' '))[1]);\n                                                        }\n                                                    }\n                                                }\n                                                if (opr_return_found) return true;//breaks foreach\n                                            });\n                                            return opr_return_found;\n                                        }(res.vout || []))\n                                    );\n                                }\n                            });\n                    case 'chain.so':\n                        return getJSON('https://chain.so/api/v2/get_tx/BTC/' + txId)\n                            .then(function (res) {\n                                if (!res || res.status == 'fail') {\n                                    throw new Error('tx_not_found');\n                                }\n                                else {\n                                    //noinspection JSUnresolvedVariable\n                                    return makeTransaction(res.data.txid, res.data.confirmations, new Date(res.data.time * 1000), res.data.blockhash,\n                                        (function (outputs) {\n                                            var opr_return_found = null;\n                                            outputs.forEach(function (output) {\n                                                if (output.hasOwnProperty('script')) {\n                                                    //noinspection JSUnresolvedVariable\n                                                    if (output.script.indexOf('OP_RETURN') != -1) {\n                                                        //noinspection JSUnresolvedVariable\n                                                        opr_return_found = (((output.script).split(' '))[1]);\n                                                    }\n                                                    if (opr_return_found) return true;//breaks foreach\n                                                }\n                                            });\n                                            return opr_return_found;\n                                        }(res.data.outputs || []))\n                                    );\n                                }\n                            });\n                    case 'blockcypher.com':\n                        return getJSON('https://api.blockcypher.com/v1/btc/main/txs/' + txId)\n                            .then(function (res) {\n                                if (!res || res.error) {\n                                    throw new Error('tx_not_found');\n                                }\n                                else {\n                                    //noinspection JSUnresolvedVariable\n                                    return makeTransaction(res.hash, res.confirmations, new Date(res.confirmed), res.block_hash,\n                                        (function (outputs) {\n                                            var opr_return_found = null;\n                                            outputs.forEach(function (output) {\n                                                if (output.hasOwnProperty('data_hex')) {\n                                                    //noinspection JSUnresolvedVariable\n                                                    opr_return_found = output.data_hex;\n                                                }\n                                                if (opr_return_found) return true;//breaks foreach\n                                            });\n                                            return opr_return_found;\n                                        }(res.outputs || []))\n                                    );\n                                }\n                            });\n                }\n            }\n        }\n    })();\n\n    /**\n     * @param {String} hash\n     * @param {Number} [size]\n     * @returns {Promise<AnchorIDsPage>}\n     */\n    api.anchor.getAnchorIDs = function (hash, size) {\n        size = size || 20;\n        return getJSON(woleetAPI + \"/anchorids?size=\" + size + \"&hash=\" + hash)\n    };\n\n\n    /**\n     * @param {String} anchorId\n     * @returns {Promise<Receipt>}\n     */\n    api.receipt.get = function (anchorId) {\n        return getJSON(woleetAPI + \"/receipt/\" + anchorId).then(function (res) {\n            if (!res) {\n                throw new Error('not_found');\n            }\n            else {\n                return res;\n            }\n        })\n    };\n\n    /**\n     * @param {Hash} hash\n     * @returns {boolean}\n     */\n    api.isSHA256 = function (hash) {\n        var sha256RegExp = /^[A-Fa-f0-9]{64}$/;\n        return sha256RegExp.test(hash);\n    };\n\n    api._getJSON = getJSON;\n    api._woleetAPI = woleetAPI;\n\n    return api;\n});\n\n","/**\n * @typedef {Object}   Leaf\n * @typedef {Hash}     Leaf.left\n * @typedef {Hash}     Leaf.right\n * @typedef {Hash}     Leaf.parent\n */\n\n/**\n * @typedef {Object}   Receipt\n * @typedef {Object}   Receipt.header\n * @typedef {String}   Receipt.header.chainpoint_version\n * @typedef {String}   Receipt.header.hash_type\n * @typedef {String}   Receipt.header.merkle_root\n * @typedef {String}   Receipt.header.tx_id\n * @typedef {String}   Receipt.header.timestamp\n * @typedef {Object}   Receipt.target\n * @typedef {String}   Receipt.target.target_hash\n * @typedef {String}   Receipt.target.target_URI\n * @typedef {Leaf[]}   Receipt.target.target_proof\n * @typedef {Object[]} Receipt.extra\n */\n\n;(function (root, factory) {\n    root.woleet = factory(root.woleet)\n})(window, function (woleet) {\n\n    /**\n     * @typedef {String} Hash\n     * @typedef {function(String): Hash} HashFunction\n     */\n\n    /**\n     * @type HashFunction\n     * @param {String} content\n     * @returns {Hash}\n     */\n\n    var sha256 = (function () {\n\n        /* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  */\n        /* SHA-256 (FIPS 180-4) implementation in JavaScript                  (c) Chris Veness 2002-2016  */\n        /*                                                                                   MIT Licence  */\n        /* www.movable-type.co.uk/scripts/sha256.html                                                     */\n        /*                                                                                                */\n        /*  - see http://csrc.nist.gov/groups/ST/toolkit/secure_hashing.html                              */\n        /*        http://csrc.nist.gov/groups/ST/toolkit/examples.html                                    */\n        /* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  */\n\n        'use strict';\n\n        function R(n, x) {\n            //noinspection JSConstructorReturnsPrimitive\n            return (x >>> n) | (x << (32 - n));\n        }\n\n        function F0(x) {\n            //noinspection JSConstructorReturnsPrimitive\n            return R(2, x) ^ R(13, x) ^ R(22, x);\n        }\n\n        function F1(x) {\n            //noinspection JSConstructorReturnsPrimitive\n            return R(6, x) ^ R(11, x) ^ R(25, x);\n        }\n\n        function S0(x) {\n            //noinspection JSConstructorReturnsPrimitive\n            return R(7, x) ^ R(18, x) ^ (x >>> 3);\n        }\n\n        function S1(x) {\n            //noinspection JSConstructorReturnsPrimitive\n            return R(17, x) ^ R(19, x) ^ (x >>> 10);\n        }\n\n        function Ch(x, y, z) {\n            //noinspection JSConstructorReturnsPrimitive\n            return (x & y) ^ (~x & z);\n        }\n\n        function Maj(x, y, z) {\n            //noinspection JSConstructorReturnsPrimitive\n            return (x & y) ^ (x & z) ^ (y & z);\n        }\n\n        return function (msg) {\n            var K = [\n                0x428a2f98, 0x71374491, 0xb5c0fbcf, 0xe9b5dba5, 0x3956c25b, 0x59f111f1, 0x923f82a4, 0xab1c5ed5,\n                0xd807aa98, 0x12835b01, 0x243185be, 0x550c7dc3, 0x72be5d74, 0x80deb1fe, 0x9bdc06a7, 0xc19bf174,\n                0xe49b69c1, 0xefbe4786, 0x0fc19dc6, 0x240ca1cc, 0x2de92c6f, 0x4a7484aa, 0x5cb0a9dc, 0x76f988da,\n                0x983e5152, 0xa831c66d, 0xb00327c8, 0xbf597fc7, 0xc6e00bf3, 0xd5a79147, 0x06ca6351, 0x14292967,\n                0x27b70a85, 0x2e1b2138, 0x4d2c6dfc, 0x53380d13, 0x650a7354, 0x766a0abb, 0x81c2c92e, 0x92722c85,\n                0xa2bfe8a1, 0xa81a664b, 0xc24b8b70, 0xc76c51a3, 0xd192e819, 0xd6990624, 0xf40e3585, 0x106aa070,\n                0x19a4c116, 0x1e376c08, 0x2748774c, 0x34b0bcb5, 0x391c0cb3, 0x4ed8aa4a, 0x5b9cca4f, 0x682e6ff3,\n                0x748f82ee, 0x78a5636f, 0x84c87814, 0x8cc70208, 0x90befffa, 0xa4506ceb, 0xbef9a3f7, 0xc67178f2];\n\n            var H = [0x6a09e667, 0xbb67ae85, 0x3c6ef372, 0xa54ff53a, 0x510e527f, 0x9b05688c, 0x1f83d9ab, 0x5be0cd19];\n\n            msg += String.fromCharCode(0x80);\n            var l = msg.length / 4 + 2;\n            var N = Math.ceil(l / 16);\n            var M = new Array(N);\n\n            for (var i = 0; i < N; i++) {\n                M[i] = new Array(16);\n                for (var j = 0; j < 16; j++) {\n                    M[i][j] = (msg.charCodeAt(i * 64 + j * 4) << 24) | (msg.charCodeAt(i * 64 + j * 4 + 1) << 16) |\n                        (msg.charCodeAt(i * 64 + j * 4 + 2) << 8) | (msg.charCodeAt(i * 64 + j * 4 + 3));\n                }\n            }\n            var lenHi = ((msg.length - 1) * 8) / Math.pow(2, 32);\n            var lenLo = ((msg.length - 1) * 8) >>> 0;\n            M[N - 1][14] = Math.floor(lenHi);\n            M[N - 1][15] = lenLo;\n\n            for (let i = 0; i < N; i++) {\n                let W = new Array(64);\n\n                for (let t = 0; t < 16; t++) W[t] = M[i][t];\n                for (let t = 16; t < 64; t++) {\n                    W[t] = (S1(W[t - 2]) + W[t - 7] + S0(W[t - 15]) + W[t - 16]) >>> 0;\n                }\n\n                let a = H[0], b = H[1], c = H[2], d = H[3], e = H[4], f = H[5], g = H[6], h = H[7];\n\n                for (let t = 0; t < 64; t++) {\n                    var T1 = h + F1(e) + Ch(e, f, g) + K[t] + W[t];\n                    var T2 = F0(a) + Maj(a, b, c);\n                    h = g;\n                    g = f;\n                    f = e;\n                    e = (d + T1) >>> 0;\n                    d = c;\n                    c = b;\n                    b = a;\n                    a = (T1 + T2) >>> 0;\n                }\n\n                H[0] = (H[0] + a) >>> 0;\n                H[1] = (H[1] + b) >>> 0;\n                H[2] = (H[2] + c) >>> 0;\n                H[3] = (H[3] + d) >>> 0;\n                H[4] = (H[4] + e) >>> 0;\n                H[5] = (H[5] + f) >>> 0;\n                H[6] = (H[6] + g) >>> 0;\n                H[7] = (H[7] + h) >>> 0;\n            }\n\n            for (var h = 0; h < H.length; h++) H[h] = ('00000000' + H[h].toString(16)).slice(-8);\n\n            return H.join('');\n        };\n    }());\n\n    /**\n     * Build a Merkle branch.\n     * @param {Hash} left\n     * @param {Hash} right\n     * @param {HashFunction} [hash_f]\n     * @constructor\n     */\n    function MerkleBranch(left, right, hash_f) {\n        /**\n         * @type {function(String): Hash}\n         */\n        var _hash_f = hash_f || sha256;\n        /***\n         * @type {Hash}\n         */\n        var _left = left;\n        /**\n         * @type {Hash}\n         */\n        var _right = right;\n        /**\n         * @type {Hash}\n         */\n        var _parent = _hash_f(_left + _right);\n\n        /**\n         * Get the parent of the branch.\n         * @returns {Hash}\n         */\n        this.get_parent = function () {\n            return _parent;\n        };\n\n        /**\n         * Check if a branch contains a hash.\n         * @param {Hash} target\n         * @returns {boolean}\n         */\n        this.contains = function (target) {\n            return _left == target || _right == target;\n        };\n\n        /**\n         * @returns {{parent: Hash, left: Hash, right: Hash}}\n         */\n        this.get_json = function () {\n            return {\n                \"parent\": _parent,\n                \"left\": _left,\n                \"right\": _right\n            }\n        };\n    }\n\n    /**\n     * Builds a Merkle proof.\n     * @param {String} target\n     * @param {Function} [hash_f]\n     * @constructor\n     */\n    function MerkleProof(target, hash_f) {\n        var self = this;\n\n        //noinspection JSUnusedGlobalSymbols\n        this.hash_f = hash_f || sha256;\n        this.branches = [];\n        this.target = target;\n\n        /**\n         * Add a branch to the proof.\n         * @param {MerkleBranch} branch\n         */\n        this.add = function (branch) {\n            self.branches.push(branch);\n        };\n\n        /**\n         * Returns the Merkle proof root if the proof is valid, false if it's not\n         * @returns {String|Boolean}\n         */\n        this.is_valid = function () {\n\n            // Check if the target hash is in the proof (we assume that the leaf is contained in the\n            // first branch of the proof) and if the parent of each branch is contained in its higher branch.\n\n            var new_target = self.target;\n\n            if (!self.branches.length) return false;\n\n            for (var i = 0, branch; i < self.branches.length; i++) {\n                branch = self.branches[i];\n                if (!(branch.contains(new_target))) {\n                    return false;\n                }\n                new_target = branch.get_parent();\n            }\n\n            return new_target;\n        };\n\n        // MerkleProof to machine readable JSON.\n        this.get_json = function () {\n            var json_data = [];\n            self.branches.forEach(function (branch) {\n                json_data.push(branch.get_json());\n            });\n            return (json_data);\n        };\n    }\n\n    var api = woleet || {};\n    api.receipt = api.receipt || {};\n\n    /**\n     * Validate a receipt.\n     * @param {Receipt} receipt\n     * @returns {Boolean} true if the receipt is valid\n     */\n    api.receipt.validate = function (receipt) {\n\n        if (!receipt || !receipt.target || !receipt.target.target_hash || !receipt.target.target_proof\n            || !(receipt.target.target_proof instanceof Array) || !receipt.header || !receipt.header.hash_type\n            || !receipt.header.merkle_root || !receipt.header.tx_id) {\n            throw new Error(\"invalid_receipt_format\");\n        }\n\n        for (var i = 0; i < receipt.target.target_proof.length; i++) {\n            var branch = receipt.target.target_proof[i];\n            if (!branch.left || !branch.right || !branch.parent) {\n                throw new Error(\"invalid_target_proof\");\n            }\n            if (!api.isSHA256(branch.left) || !api.isSHA256(branch.right) || !api.isSHA256(branch.parent)) {\n                throw new Error(\"non_sha256_target_proof_element\");\n            }\n        }\n\n        // If no Merkle proof\n        if (receipt.target.target_proof.length == 0) {\n\n            // Receipt is valid if its target hash is equal to its Merkle root\n            if (receipt.target.target_hash == receipt.header.merkle_root) return true;\n            else throw new Error(\"merkle_root_mismatch\");\n        }\n\n        // If there is a Merkle proof\n        else {\n\n            // Build the Merkle proof while checking its integrity\n            var proof = new MerkleProof(receipt.target.target_hash);\n            receipt.target.target_proof.forEach(function (branch) {\n\n                // Build a new Merkle branch\n                var merkleBranch = new MerkleBranch(branch.left, branch.right);\n\n                // Check that provided parent is correctly computed\n                if (!merkleBranch.get_parent() == branch.parent) {\n                    throw new Error(\"invalid_parent_in_proof_element\");\n                }\n\n                // Add Merkle branch to the Merkle proof\n                proof.add(merkleBranch);\n            });\n\n            // Receipt is valid if its Merkle root is equal to the Merkle proof root\n            if (proof.is_valid() == receipt.header.merkle_root) return true;\n            else throw new Error(\"merkle_root_mismatch\");\n        }\n    };\n\n    return api;\n});\n\n",";(function (root, factory) {\n    root.woleet = factory(root.woleet)\n})(window, function (woleet) {\n\n    const api = woleet || {};\n    api.receipt = api.receipt || {};\n    api.anchor = api.anchor || {};\n    api.verify = api.verify || {};\n\n    /**\n     * @param {File|String} file\n     * @param {Function} [progressCallback]\n     * @returns {Promise.<Object[]>}\n     */\n    api.verify.WoleetDAB = function (file, progressCallback) {\n\n        return api.hashFileOrCheckHash(file, progressCallback)\n\n        // We got the hash, now we get all corresponding public anchors ids\n            .then((hash) => api.anchor.getAnchorIDs(hash))\n\n            // We got public anchors ids (as an array)\n            .then((anchorIDsPage) => {\n\n                // For each public anchor, get the corresponding receipt\n                const receiptArray = [];\n                return anchorIDsPage.content.reduce((chain, anchorId) => {\n                    return chain.then(() => {\n                        return api.receipt.get(anchorId)\n                            .then((receipt) => receiptArray.push(receipt))\n                            .catch((error) => {\n                                // If we cannot get the corresponding receipt for\n                                // this anchorID because it's not yet processed (202)\n                                // we ignore this element, else we forward error\n                                if (error.code != 202) throw error;\n                            })\n                    })\n                }, Promise.resolve())\n\n                // Forward the receipt array\n                    .then(() => {\n                        // If we had a match but can't get a receipt\n                        if (!receiptArray.length && anchorIDsPage.content.length) {\n                            throw new Error('file_matched_but_anchor_not_yet_processed')\n                        }\n\n                        return receiptArray;\n                    });\n            })\n\n            // We got all public anchor receipts\n            .then((receiptArray) => {\n\n                // For each receipt we got\n                const receiptsCheckOk = receiptArray.map((receipt) => {\n                    try {\n                        // Validate the receipt\n                        api.receipt.validate(receipt);\n                        return true;\n                    } catch (err) {\n                        return false;\n                    }\n                });\n\n                // If all receipts are validated\n                const receiptsOk = receiptsCheckOk.every((e) => e == true);\n                if (receiptsOk) {\n\n                    // Build the result array\n                    const finalArray = [];\n                    return receiptArray.reduce((chain, receipt) => {\n                        return chain.then(() => {\n\n                            // Get the corresponding transaction\n                            return api.transaction.get(receipt.header.tx_id).then((tx) => {\n\n                                // Check that receipt's Merkle root matches transaction's OP_RETURN\n                                if (tx.opReturn == receipt.header.merkle_root) {\n                                    finalArray.push({\n                                        receipt: receipt,\n                                        confirmations: tx.confirmations,\n                                        confirmedOn: tx.confirmedOn\n                                    });\n                                }\n                                else\n                                    throw new Error('opReturn_mismatches_merkleRoot')\n                            })\n                        })\n                    }, Promise.resolve())\n\n                    // We got an array of object with {receipt, confirmations, confirmedOn}, so we forward it\n                        .then(() => finalArray)\n                }\n                else {\n                    throw new Error(\"invalid_receipt\");\n                }\n            })\n    };\n\n    /**\n     * @param {File|String} file\n     * @param {Receipt} receipt\n     * @param {Function} [progressCallback]\n     * @returns {Promise<Object>}\n     */\n    api.verify.DAB = function (file, receipt, progressCallback) {\n\n        return api.hashFileOrCheckHash(file, progressCallback)\n\n        // We got the hash\n            .then((hash) => {\n\n                // Validate the receipt\n                api.receipt.validate(receipt);\n\n                // Check that receipt's target hash matches the hash\n                if (receipt.target.target_hash != hash) throw new Error(\"target_hash_mismatch\");\n\n                // Get the transaction\n                return api.transaction.get(receipt.header.tx_id)\n                    .catch((error) => {\n                        if (error.message == 'tx_not_found') {\n                            throw error;\n                        }\n                        else {\n                            // We try a second time with a different provider\n                            api.transaction.setDefaultProvider('blockcypher.com');\n                            return api.transaction.get(receipt.header.tx_id);\n                        }\n                    })\n                    .catch((error) => {\n                        if (error.message == 'tx_not_found') {\n                            throw error;\n                        }\n                        else {\n                            throw new Error(\"error_while_getting_transaction\");\n                        }\n                    })\n            })\n\n            // We got the transaction\n            .then((tx) => {\n\n                // Check that receipt's Merkle root matches transaction's OP_RETURN\n                if (tx.opReturn == receipt.header.merkle_root)\n\n                // Return the result\n                    return {\n                        receipt: receipt,\n                        confirmations: tx.confirmations,\n                        confirmedOn: tx.confirmedOn\n                    };\n                else\n                    throw new Error('opReturn_mismatches_merkleRoot')\n            })\n    };\n\n    return api;\n});","/**\n * @typedef {Object}   ProgressMessage\n * @typedef {Number}   ProgressMessage.progress (float number)\n * @typedef {File}     ProgressMessage.file\n */\n\n/**\n * @typedef {Object}   StartMessage\n * @typedef {Boolean}  StartMessage.start always true\n * @typedef {File}     ProgressMessage.file\n */\n\n/**\n * @typedef {Object}   ErrorMessage\n * @typedef {Error}    ErrorMessage.error\n * @typedef {File}     EndMessage.file\n */\n\n/**\n * @typedef {Object}   EndMessage\n * @typedef {String}   EndMessage.end hash of the file\n * @typedef {File}     EndMessage.file\n */\n\n;(function (root, factory) {\n    root.woleet = factory(root.woleet)\n})(window, function (woleet) {\n\n    const api = woleet || {};\n    api.file = api.file || {};\n\n    const isHTTPS = location.protocol == 'https:';\n\n    //noinspection JSUnresolvedVariable\n    const testNativeCryptoSupport = window.crypto && window.crypto.subtle && window.crypto.subtle.digest && isHTTPS;\n\n    const testFileReaderSupport = checkFileReaderSyncSupport();\n\n    /**\n     * @returns {String} get the base path (including final '/') of the current script.\n     */\n    function findBasePath() {\n        let scripts = document.getElementsByTagName('script');\n        let scriptsArray = Array.prototype.slice.call(scripts, 0); // Converts collection to array\n        let regex = /.*woleet-(hashfile|weblibs)[.min]*\\.js$/;\n        let script = scriptsArray.find((script) => script.src && script.src.match(regex));\n        return script && script.src ? script.src.substr(0, script.src.lastIndexOf(\"/\") + 1) : null;\n    }\n\n    // Guess the path of the worker script: same as current script's or defined by woleet.workerScriptPath\n    let basePath = findBasePath();\n    let DEFAULT_WORKER_SCRIPT = \"woleet-hashfile-worker.min.js\";\n    //noinspection JSUnresolvedVariable\n    let workerScriptPath = (api.workerScriptPath || (basePath ? basePath + DEFAULT_WORKER_SCRIPT : null));\n    if (!workerScriptPath)\n        throw new Error('Cannot find ' + DEFAULT_WORKER_SCRIPT);\n\n    /**\n     * Check support for workers.\n     */\n    function checkFileReaderSyncSupport() {\n\n        function makeWorker(script) {\n            //noinspection JSUnresolvedVariable\n            let URL = window.URL || window.webkitURL;\n            let Blob = window.Blob;\n            let Worker = window.Worker;\n\n            if (!URL || !Blob || !Worker || !script) return null;\n\n            let blob = new Blob([script]);\n            //noinspection JSUnresolvedFunction\n            return new Worker(URL.createObjectURL(blob));\n        }\n\n        return new Promise(function (resolve) {\n            let syncDetectionScript = \"onmessage = function(e) { postMessage(!!FileReaderSync); };\";\n            try {\n                let worker = makeWorker(syncDetectionScript);\n                if (worker) {\n                    worker.onmessage = function (e) {\n                        resolve(e.data);\n                    };\n                    worker.postMessage({});\n                }\n                else resolve(false);\n            } catch (err) {\n                resolve(false);\n            }\n        });\n    }\n\n    api.file.Hasher = function () {\n\n        let ready = true;\n        let cb_start, cb_progress, cb_result, cb_error;\n\n        /**\n         * @param {String} event\n         * @param {Function} callback\n         */\n        this.on = function (event, callback) {\n            switch (event) {\n                case 'start':\n                    cb_start = callback;\n                    break;\n                case 'progress':\n                    cb_progress = callback;\n                    break;\n                case 'error':\n                    cb_error = callback;\n                    break;\n                case 'result':\n                    cb_result = callback;\n                    break;\n                default:\n                    throw new Error('Invalid event name \"' + event + '\"');\n            }\n        };\n\n        /**\n         * @constructor\n         */\n        const HashWorker = function () {\n\n            let worker = new Worker(workerScriptPath);\n\n            /**\n             * @param {File} file\n             * @returns {Promise}\n             */\n            this.hash = function (file) {\n                return new Promise((next, reject) => {\n\n                    worker.onmessage = function (message) {//handling worker message\n                        if (message.data.progress != undefined) {\n                            if (cb_progress) cb_progress(message.data);\n                        }\n                        else if (message.data.result) {\n                            if (cb_result) cb_result(message.data);\n                            next(worker);\n                        }\n                        else if (message.data.start) {\n                            if (cb_start) cb_start(message.data);\n                        }\n                        else if (message.data.error) {\n                            let error = message.data.error;\n                            if (cb_error) cb_error(error);\n                            else reject(error);\n                        }\n                        else {\n                            console.trace(\"Unexpected worker message: \", message);\n                        }\n                    };\n\n                    worker.postMessage(file);\n                });\n            };\n\n        };\n\n        /**\n         * @param {File} file\n         * @returns {Promise}\n         */\n        const hashLocal = function (file) {\n\n            return new Promise((next, reject) => {\n                let error = new Error(\"file_too_big_to_be_hashed_without_worker\");\n                if (file.size > 5e7) {\n                    ready = true;\n                    if (cb_error) return cb_error({error: error, file: file});\n                    else reject(error);\n                }\n\n                let reader = new FileReader();\n\n                let sha256 = CryptoJS.algo.SHA256.create();\n                let hash, prev = 0;\n\n                reader.onloadstart = () => {\n                    if (cb_start) cb_start({start: true, file: file});\n                };\n\n                reader.onloadend = () => {\n                    hash.finalize();\n                    if (cb_result) cb_result({\n                        result: hash._hash.toString(CryptoJS.enc.Hex),\n                        file: file\n                    });\n                    next();\n                };\n\n                reader.onprogress = (e) => {\n                    //noinspection JSUnresolvedVariable\n                    /** @type ArrayBuffer */\n                    let buf = e.target.result;\n                    //noinspection JSUnresolvedVariable\n                    let blob = buf.slice(prev, e.loaded);\n                    let chunkUint8 = new Uint8Array(blob);\n                    let wordArr = CryptoJS.lib.WordArray.create(chunkUint8);\n                    hash = sha256.update(wordArr);\n                    //noinspection JSUnresolvedVariable\n                    prev = e.loaded;\n                    if (cb_progress) {\n                        //noinspection JSUnresolvedVariable\n                        cb_progress({progress: (e.loaded / e.total), file: file});\n                    }\n                };\n\n                reader.readAsArrayBuffer(file);\n            });\n        };\n\n        /**\n         * @param {File} file\n         * @returns {Promise}\n         */\n        const hashLocalWithNativeAPI = function (file) {\n            return new Promise((resolve, reject) => {\n                let algo = \"SHA-256\";\n                // entry point\n                let reader = new FileReader();\n\n                reader.onloadstart = () => {\n                    if (cb_start) cb_start({start: true, file: file});\n                };\n\n                reader.onprogress = (e) => {\n                    if (cb_progress) { //noinspection JSUnresolvedVariable\n                        cb_progress({progress: (e.loaded / e.total), file: file});\n                    }\n                };\n\n                reader.onload = function (event) {\n                    let data = event.target.result;\n                    //noinspection JSUnresolvedFunction,JSUnresolvedVariable\n                    window.crypto.subtle.digest(algo, data)\n                        .then(function (hash) {\n                            let hashResult = new Uint8Array(hash);\n                            let hexString = hashResult.reduce((res, e) => res + ('00' + e.toString(16)).slice(-2), '');\n                            if (cb_result) cb_result({result: hexString, file: file});\n                            resolve();\n                        })\n                        .catch((error) => cb_error ? cb_error({error: error, file: file}) : reject(error));\n                };\n\n                reader.readAsArrayBuffer(file);\n            })\n        };\n\n        this.start = function (files) {\n\n            const max_native_crypto_size = 5e8; // ~500MB\n\n            let hashWorker = null; // We may have to keep the hashWorker\n\n            if (!ready) throw new Error(\"not_ready\");\n\n            ready = false;\n\n            // checking input type\n            if (!(files instanceof FileList || files instanceof File))\n                throw new Error(\"invalid_parameter\");\n\n            testFileReaderSupport\n                .then((WorkerSupported) => {\n\n                    /**\n                     * iterator function with selected hash method\n                     * @param {Number} i current index of the list\n                     * @param {Number} len total size of the list\n                     * @param {FileList|[File]} files file list\n                     * @param {Worker} [worker] passing worker through iterator if selected method is hashWorker in order to terminate it\n                     */\n                    function iter(i, len, files, worker) {\n\n                        if ((i >= len)) {\n                            ready = true;\n                            if (worker) worker.terminate();\n                        }\n                        else {\n\n                            // We choose here the better method to hash a file\n                            let hashMethod = null;\n                            if (testNativeCryptoSupport && files[i].size < max_native_crypto_size) {\n                                hashMethod = hashLocalWithNativeAPI;\n                            }\n                            else if (WorkerSupported) {\n                                if (!hashWorker) hashWorker = new HashWorker(); // if worker instance has already been called\n                                hashMethod = hashWorker.hash;\n                            }\n                            else if (typeof CryptoJS !== 'undefined') {\n                                hashMethod = hashLocal;\n                            }\n                            else {\n                                throw new Error(\"no_viable_hash_method\");\n                            }\n\n                            hashMethod(files[i]).then((_worker) => {\n                                iter(i + 1, len, files, _worker || worker);\n                            })\n                        }\n                    }\n\n                    // entry point\n                    if (files instanceof FileList) { // files is a FileList\n                        iter(0, files.length, files);\n                    }\n                    else if (files instanceof File) { // files is a single file\n                        iter(0, 1, [files]);\n                    }\n                })\n\n        };\n\n        this.isReady = function () {\n            return ready;\n        };\n    };\n\n    /**\n     * @param {File|String} file\n     * @param {Function} [progressCallback]\n     * @returns {Promise<Hash>}\n     */\n    api.hashFileOrCheckHash = (file, progressCallback) => {\n        return new Promise((resolve, reject) => {\n\n            // If parameter is a file, hash it\n            if (file instanceof File) {\n\n                if (!api.file || !api.file.Hasher)\n                    throw new Error(\"missing_woleet_hash_dependency\");\n\n                const hasher = new api.file.Hasher;\n\n                hasher.on('result', (message, file) => {\n                    resolve(message.result);\n                    if (progressCallback)\n                        progressCallback({progress: 1.0, file: file})\n                });\n\n                if (progressCallback && typeof progressCallback == 'function')\n                    hasher.on('progress', progressCallback);\n\n                hasher.on('error', reject);\n\n                hasher.start(file)\n            }\n\n            // If parameter is a hash, check it is a valid SHA256 hash\n            else if (typeof file == \"string\") {\n                if (api.isSHA256(file))\n                    resolve(file);\n                else\n                    reject(new Error(\"parameter_string_not_a_sha256_hash\"));\n            }\n\n            // Invalid parameter\n            else\n                reject(new Error(\"invalid_parameter\"));\n        });\n    };\n\n    return api;\n});"]}