"use strict";!function(e,r){e.woleet=r(e.woleet)}(window,function(e){var r=e||{};r.receipt=r.receipt||{},r.anchor=r.anchor||{},r.verify=r.verify||{},r.verify.WoleetDAB=function(e){return n(e).then(function(e){return r.anchor.getAnchorIDs(e)}).then(function(e){var n=[];return e.content.reduce(function(e,t){return e.then(function(){return r.receipt.get(t).then(function(e){return n.push(e)},function(e){if(202!=e.code)throw e})})},Promise.resolve()).then(function(){if(!n.length&&e.content.length)throw new Error("file_matched_but_anchor_not_yet_processed");return n})}).then(function(e){var n=e.map(function(e){try{return r.receipt.validate(e)}catch(e){return!1}}),t=n.every(function(e){return 1==e}),o=[];if(t)return e.reduce(function(e,n){return e.then(function(){return r.transaction.get(n.header.tx_id).then(function(e){o.push({receipt:n,confirmations:e.confirmations,date:e.confirmedAt})})})},Promise.resolve()).then(function(){return o});throw new Error("invalid_receipt")})},r.verify.DAB=function(e,t){return n(e).then(function(e){if(r.receipt.validate(t),t.target.target_hash!=e)throw new Error("target_hash_mismatch");return r.transaction.get(t.header.tx_id).then(function(e){return e},function(e){throw"tx_not_found"==e.message?e:new Error("error_while_getting_transaction")})}).then(function(e){if(e.opReturn==t.header.merkle_root)return{receipt:t,confirmations:e.confirmations,date:e.confirmedAt};throw new Error("opReturn_mismatches_merkleRoot")})};var n=function(e){var n,t,o=new Promise(function(e,r){n=e,t=r});if(e instanceof File){if(!r.file||!r.file.Hasher)throw new Error("missing_woleet_hash_dependency");var i=new r.file.Hasher;i.on("result",function(e,r){n(e.result)}),i.on("error",function(e){t(e)}),i.start(e)}else"string"==typeof e?r.isSHA256(e)?n(e):t(new Error("parameter_string_not_a_sha256_hash")):t(new Error("invalid_parameter"));return o};return r});
//# sourceMappingURL=woleet-verify.min.js.map
