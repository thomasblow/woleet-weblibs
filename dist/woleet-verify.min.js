"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(t,e){t.woleet=e(t.woleet)}(window,function(t){var e=t||{};return e.receipt=e.receipt||{},e.anchor=e.anchor||{},e.verify=e.verify||{},e.verify.WoleetDAB=function(t,n){return e.hashFileOrCheckHash(t,n).then(function(t){return e.anchor.getAnchorIDs(t)}).then(function(t){var n=[];return t.content.reduce(function(t,r){return t.then(function(){return e.receipt.get(r).then(function(t){return n.push(t)}).catch(function(t){if(202!=t.code)throw t})})},Promise.resolve()).then(function(){if(!n.length&&t.content.length)throw new Error("file_matched_but_anchor_not_yet_processed");return n})}).then(function(t){var n=t.map(function(t){try{return e.receipt.validate(t),!0}catch(t){return!1}}),r=n.every(function(t){return 1==t});if(!r)throw new Error("invalid_receipt");var o=function(){var n=[];return{v:t.reduce(function(t,r){return t.then(function(){return e.transaction.get(r.header.tx_id).then(function(t){if(t.opReturn!=r.header.merkle_root)throw new Error("opReturn_mismatches_merkleRoot");n.push({receipt:r,confirmations:t.confirmations,confirmedOn:t.confirmedOn})})})},Promise.resolve()).then(function(){return n})}}();if("object"===("undefined"==typeof o?"undefined":_typeof(o)))return o.v})},e.verify.DAB=function(t,n,r){return e.hashFileOrCheckHash(t,r).then(function(t){if(e.receipt.validate(n),n.target.target_hash!=t)throw new Error("target_hash_mismatch");return e.transaction.get(n.header.tx_id).catch(function(t){if("tx_not_found"==t.message)throw t;return e.transaction.setDefaultProvider("blockcypher.com"),e.transaction.get(n.header.tx_id)}).catch(function(t){throw"tx_not_found"==t.message?t:new Error("error_while_getting_transaction")})}).then(function(t){if(t.opReturn==n.header.merkle_root)return{receipt:n,confirmations:t.confirmations,confirmedOn:t.confirmedOn};throw new Error("opReturn_mismatches_merkleRoot")})},e});
//# sourceMappingURL=woleet-verify.min.js.map
