"use strict";!function(e,t){e.woleet=t(e.woleet)}(window,function(e){var t=e||{};return t.receipt=t.receipt||{},t.anchor=t.anchor||{},t.verify=t.verify||{},t.verify.WoleetDAB=function(e,r){return t.hashFileOrCheckHash(e,r).then(function(e){return t.anchor.getAnchorIDs(e)}).then(function(e){var r=[];return e.content.reduce(function(e,n){return e.then(function(){return t.receipt.get(n).then(function(e){return r.push(e)}).catch(function(e){if(202!=e.code)throw e})})},Promise.resolve()).then(function(){if(!r.length&&e.content.length)throw new Error("file_matched_but_anchor_not_yet_processed");return r})}).then(function(e){var r=e.map(function(e){try{return t.receipt.validate(e),!0}catch(e){return!1}}),n=r.every(function(e){return 1==e});if(n){var o=[];return e.reduce(function(e,r){return e.then(function(){return t.transaction.get(r.header.tx_id).then(function(e){if(e.opReturn!=r.header.merkle_root)throw new Error("opReturn_mismatches_merkleRoot");o.push({receipt:r,confirmations:e.confirmations,confirmedOn:e.confirmedOn})})})},Promise.resolve()).then(function(){return o})}throw new Error("invalid_receipt")})},t.verify.DAB=function(e,r,n){return t.hashFileOrCheckHash(e,n).then(function(e){if(t.receipt.validate(r),r.target.target_hash!=e)throw new Error("target_hash_mismatch");return t.transaction.get(r.header.tx_id).catch(function(e){if("tx_not_found"==e.message)throw e;return t.transaction.setDefaultProvider("blockcypher.com"),t.transaction.get(r.header.tx_id)}).catch(function(e){throw"tx_not_found"==e.message?e:new Error("error_while_getting_transaction")})}).then(function(e){if(e.opReturn==r.header.merkle_root)return{receipt:r,confirmations:e.confirmations,confirmedOn:e.confirmedOn};throw new Error("opReturn_mismatches_merkleRoot")})},t});
//# sourceMappingURL=woleet-verify.min.js.map
